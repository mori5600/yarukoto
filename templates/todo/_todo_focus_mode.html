<!-- フォーカスモード用のフルスクリーンオーバーレイ -->
<div id="todo-focus-mode" class="todo-focus-mode p-focus">
    <div class="todo-focus-mode__header">
        <div class="todo-focus-mode__header-left">
            <button class="todo-focus-mode__close"
                    hx-get="{% url 'todo:exit_focus_mode' %}"
                    hx-target="#todo-focus-mode"
                    hx-swap="outerHTML"
                    title="フォーカスモード終了 (Esc)">
                <svg xmlns="http://www.w3.org/2000/svg"
                     width="24"
                     height="24"
                     fill="currentColor"
                     viewBox="0 0 16 16">
                    <path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8z" />
                </svg>
            </button>
        </div>
        <div class="todo-focus-mode__timer" id="pomodoro-timer">
            <button id="timer-settings"
                    type="button"
                    class="btn btn-sm btn-outline-secondary"
                    aria-controls="timer-settings-panel"
                    aria-expanded="false"
                    title="タイマー設定">⚙️</button>
            <span id="timer-display">25:00</span>
            <button id="timer-start" class="btn btn-sm btn-success">開始</button>
            <button id="timer-pause"
                    class="btn btn-sm btn-warning todo-focus-mode__timer-pause--hidden">一時停止</button>
            <button id="timer-reset" class="btn btn-sm btn-secondary">リセット</button>
        </div>
    </div>
    <!-- タイマー設定パネル（デフォルトは非表示） -->
    <div id="timer-settings-panel"
         class="todo-focus-mode__settings-panel todo-focus-mode__settings-panel--hidden"
         aria-hidden="true">
        <div class="todo-focus-mode__settings-content">
            <div class="todo-focus-mode__settings-header">
                <h5>⏱️ タイマー設定</h5>
                <button type="button"
                        id="timer-settings-close"
                        class="todo-focus-mode__settings-close"
                        aria-label="閉じる">×</button>
            </div>
            <div class="mb-3">
                <label for="timer-work-duration" class="form-label">作業時間（分）</label>
                <input type="number"
                       id="timer-work-duration"
                       class="form-control"
                       min="1"
                       max="120"
                       value="25">
            </div>
            <div class="mb-3">
                <label for="timer-break-duration" class="form-label">休憩時間（分）</label>
                <input type="number"
                       id="timer-break-duration"
                       class="form-control"
                       min="1"
                       max="60"
                       value="5">
            </div>
            <div class="mb-3">
                <label for="timer-long-break-duration" class="form-label">長休憩時間（分）</label>
                <input type="number"
                       id="timer-long-break-duration"
                       class="form-control"
                       min="1"
                       max="60"
                       value="15">
            </div>
            <div class="mb-3">
                <label for="timer-sessions-before-long-break" class="form-label">長休憩までのセッション数</label>
                <input type="number"
                       id="timer-sessions-before-long-break"
                       class="form-control"
                       min="1"
                       max="10"
                       value="4">
            </div>
            <div class="mb-3">
                <label class="form-label">通知</label>
                <div id="notification-permission-status"
                     class="todo-focus-mode__notification-status"></div>
                <button type="button"
                        id="notification-permission-btn"
                        class="btn btn-outline-secondary btn-sm w-100">
                    🔔
                    通知を許可する
                </button>
            </div>
            <div class="d-flex gap-2">
                <button id="timer-settings-save" type="button" class="btn btn-primary">保存</button>
                <button id="timer-settings-cancel" type="button" class="btn btn-secondary">キャンセル</button>
            </div>
        </div>
    </div>
    <div class="todo-focus-mode__content">{% include "todo/_todo_focus_item.html" %}</div>
    <div class="todo-focus-mode__actions">
        <button class="btn btn-outline-primary btn-lg"
                hx-get="{% url 'todo:edit_todo_item' todo_item.pk %}?focus=1&page={{ current_page }}{% if list_querystring %}&{{ list_querystring }}{% endif %}"
                hx-target="#todo-focus-item"
                hx-swap="outerHTML">編集</button>
        <button class="btn btn-outline-danger btn-lg"
                hx-delete="{% url 'todo:delete_todo_item' todo_item.pk %}?focus=1&page={{ current_page }}{% if list_querystring %}&{{ list_querystring }}{% endif %}"
                hx-target="this"
                hx-swap="none"
                hx-confirm="本当に削除しますか？">削除</button>
    </div>
</div>
