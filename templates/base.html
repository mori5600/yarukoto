<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="description"
              content="Simple Django Todo application for managing tasks." />
        <meta name="keywords"
              content="django, todo, tasks, todo-list, productivity" />
        <link rel="icon" href="/static/favicon/favicon.ico" sizes="any" />
        <link rel="icon" type="image/svg+xml" href="/static/favicon/favicon.svg" />
        <link rel="icon"
              type="image/png"
              sizes="32x32"
              href="/static/favicon/favicon-32x32.png" />
        <link rel="icon"
              type="image/png"
              sizes="16x16"
              href="/static/favicon/favicon-16x16.png" />
        <link rel="apple-touch-icon" href="/static/favicon/apple-touch-icon.png" />
        <link rel="manifest" href="/static/favicon/site.webmanifest" />
        <!-- App -->
        <link rel="stylesheet" href="/static/css/app/index.css" />
        <title>Yarukoto</title>
        <script>
        (function () {
            const STORAGE_KEY = "app-theme-preference";
            const saved = localStorage.getItem(STORAGE_KEY) || "auto";
            const html = document.documentElement;
            const prefersDark = window.matchMedia &&
                window.matchMedia("(prefers-color-scheme: dark)").matches;

            if (saved === "auto") {
                html.removeAttribute("data-theme");
                html.setAttribute("data-bs-theme", prefersDark ? "dark" : "light");
                html.style.colorScheme = "light dark";
            } else if (saved === "light") {
                html.setAttribute("data-theme", "light");
                html.setAttribute("data-bs-theme", "light");
                html.style.colorScheme = "light";
            } else if (saved === "dark") {
                html.setAttribute("data-theme", "dark");
                html.setAttribute("data-bs-theme", "dark");
                html.style.colorScheme = "dark";
            }
        })();
        </script>
    </head>
    <body hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'>
        <header>
            <nav class="navbar bg-body-tertiary">
                <div class="container">
                    <div class="d-flex align-items-center gap-3">
                        <a class="navbar-brand mb-0 h1 d-flex align-items-center" href="/">
                            <img src="/static/favicon/favicon-32x32.png"
                                 width="20"
                                 height="20"
                                 class="me-2"
                                 alt=""
                                 aria-hidden="true" />
                            Yarukoto
                        </a>
                        <a class="nav-link text-muted" href="{% url 'info:docs' %}">Docs</a>
                    </div>
                    <div class="d-flex align-items-center gap-2">
                        <div class="dropdown">
                            <button id="theme-toggle-btn"
                                    type="button"
                                    class="btn btn-sm btn-outline-secondary dropdown-toggle"
                                    data-bs-toggle="dropdown"
                                    aria-expanded="false"
                                    aria-label="„ÉÜ„Éº„ÉûÈÅ∏Êäû">
                                <span class="theme-icon">üåê</span>
                            </button>
                            <ul class="dropdown-menu dropdown-menu-end"
                                aria-labelledby="theme-toggle-btn">
                                <li>
                                    <a class="dropdown-item theme-option" data-theme="auto" href="#"><span class="me-2">üåê</span>OS‰æùÂ≠ò</a>
                                </li>
                                <li>
                                    <a class="dropdown-item theme-option" data-theme="light" href="#"><span class="me-2">‚òÄÔ∏è</span>„É©„Ç§„Éà„É¢„Éº„Éâ</a>
                                </li>
                                <li>
                                    <a class="dropdown-item theme-option" data-theme="dark" href="#"><span class="me-2">üåô</span>„ÉÄ„Éº„ÇØ„É¢„Éº„Éâ</a>
                                </li>
                            </ul>
                        </div>
                        {% if user.is_authenticated %}
                            <span class="text-muted small me-1">{{ user.get_username }}</span>
                            <form method="post" action="{% url 'account_logout' %}" class="m-0">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-sm btn-outline-secondary">„É≠„Ç∞„Ç¢„Ç¶„Éà</button>
                            </form>
                        {% else %}
                            <a class="btn btn-sm btn-outline-primary"
                               href="{% url 'accounts:signup' %}">ÁôªÈå≤</a>
                            <a class="btn btn-sm btn-primary" href="{% url 'account_login' %}">„É≠„Ç∞„Ç§„É≥</a>
                        {% endif %}
                    </div>
                </div>
            </nav>
        </header>
        <main class="container mt-4">
            {% block content %}
            {% endblock content %}
        </main>
        <!-- Vendor -->
        <script src="/static/js/vendor/jquery-3.7.1.min.js"></script>
        <script src="/static/js/vendor/bootstrap.bundle.min.js"></script>
        <script src="/static/js/vendor/htmx.min.js"></script>
        <!-- App: Core -->
        <script src="/static/js/app/core/pomodoro-timer.js"></script>
        <script src="/static/js/app/core/notification.js"></script>
        <!-- App: UI -->
        <script src="/static/js/app/ui/theme.js"></script>
        <script src="/static/js/app/ui/app.js"></script>
        <script src="/static/js/app/ui/focus.js"></script>
        {% block extra_body %}
        {% endblock extra_body %}
    </body>
</html>
